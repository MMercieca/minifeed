<% content_for :breadcrumbs do %>
  <%= build_breadcrumbs([ ["/dashboard", "Dashboard"], [main_feeds_url(identifier: @main_feed.identifier), @main_feed.name], [nil, @mini_feed.name] ]) %>
<% end %>
<%= render partial: "/shared/card", locals: { feed: @mini_feed, path: "/mini_feeds/#{@mini_feed.id }?identifier=#{@main_feed.identifier}", classes: "listen-wrapper" } %>
<% @episodes.each_with_index do |ep, i| %>
  <% episode = Episode.new(ep) %>
  <div class="flex lg:w-1/3 md:w-1/2 sm:w-full m-auto mb-4 p-2 border-transparent border-2 card-wrapper listen-wrapper" >
    <div class="bg-white w-full h-full border-gray shadow card p-4">
      <h3><%= episode.title %></h3>
      <%= episode.description.html_safe %>
      <br />
      <a class="blue-glow w-1/4 text-center uppercase bg-dark-blue text-sm text-white font-bold py-2 px-4"
        style="color: white" id="set_<%= i %>" href="javascript:play(<%= i %>, '<%= episode.url %>')">Play</a>
      <div id="play_<%= i %>">
      </div>
    </div>
  </div>
<% end %>
<script>
  function play(i, url) {
    controls = document.createElement('audio');
    controls.controls = "controls";
    controls.preload = "auto";
    controls.style.width = "100%";
    source = document.createElement('source');
    source.src = url;
    source.type = "audio/mpeg";
    controls.appendChild(source);
    player = document.getElementById('play_' + i);
    player.appendChild(controls);

    button = document.getElementById('set_' + i);
    button.style.display="none"; 
  }
</script>